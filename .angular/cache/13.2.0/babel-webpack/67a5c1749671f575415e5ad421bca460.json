{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Financeiro } from 'src/app/financeiro/financeiro';\nimport { Atendimento } from '../atendimento';\nimport { Prontuario } from '../prontuario';\nlet ProntuarioFormComponent = class ProntuarioFormComponent {\n  constructor(service, router, acttivatedRouter) {\n    this.service = service;\n    this.router = router;\n    this.acttivatedRouter = acttivatedRouter;\n    this.denteNumeral = [11, 12, 13, 14, 15, 16, 17, 18, 21, 22, 23, 24, 25, 26, 27, 28, 31, 32, 33, 34, 35, 36, 37, 38, 41, 42, 43, 44, 45, 46, 47, 48];\n    this.paciente = [];\n    this.myimg = \"assets/odontograma.png\";\n    this.key = 'id'; // Define um valor padrão, para quando inicializar o componente\n\n    this.reverse = false;\n    this.prontuario = new Prontuario();\n    this.finan = new Financeiro();\n    this.atend = new Atendimento();\n  }\n\n  ngOnInit() {\n    this.pacientes = this.service.getPaciente();\n    let params = this.acttivatedRouter.params;\n    params.subscribe(urlParams => {\n      this.id = urlParams['id'];\n\n      if (this.id) {\n        this.service.getProntuarioById(this.id).subscribe(response => this.prontuario = response, errorResponse => this.prontuario = new Prontuario());\n        this.service.getAtendsByPront(this.id).subscribe(response => this.atendimento = response);\n      }\n    });\n  }\n\n  buscarPaciente(x) {\n    this.service.getPacienteByName(this.prontuario.paciente.paciente).subscribe(response => {\n      this.pacientes = response;\n    }, errorResponse => {\n      this.errors = errorResponse.error.errors;\n    });\n  }\n\n  selectPaciente(x) {\n    this.prontuario.paciente.id = x;\n  }\n\n  refresh(pacs) {\n    this.service.getProntByPac(pacs.id).subscribe(response => {\n      if (response.id) {\n        this.router.navigate([`prontuario/form/${response.id}`]);\n      }\n    }, errorResponse => {\n      this.router.navigate([`prontuario/form/`]);\n      this.prontuario.paciente = pacs;\n      this.errors = errorResponse.error.errors;\n    });\n  }\n\n  novo() {\n    this.router.navigate([`prontuario/form`]);\n  }\n\n  dentesComAnotacao(dentes) {\n    for (let i = 0; i < this.prontuario.dentes.length; i++) {\n      if (this.prontuario.dentes[i] == dentes) {\n        return this.denteNumeral[i];\n      }\n    }\n  }\n\n  limparCampo(x) {\n    this.prontuario.dentes[x] == null;\n  }\n\n  onSubmit() {\n    console.log(this.prontuario);\n\n    if (this.id) {\n      this.service.putProntuario(this.prontuario).subscribe(response => {\n        this.success = true;\n        this.errors = null;\n      }, errorResponse => {\n        console.log(this.errors);\n        this.errors = ['Erro ao Atualizar.'];\n      });\n    } else {\n      this.service.salvarProntuario(this.prontuario).subscribe(response => {\n        this.prontuario = response;\n        this.router.navigate([`/prontuario/form/${this.prontuario.id}`]);\n        this.errors = null;\n        this.success = true;\n      }, errorResponse => {\n        this.success = false;\n        this.errors = errorResponse.error.errors;\n      });\n    }\n  }\n\n  voltar() {\n    this.router.navigate([\"/prontuario/list\"]);\n  }\n\n  enviarParaFinanceiroEAtendimento() {\n    if (this.prontuario.id) {\n      this.finan.prontuario = this.prontuario;\n      this.finan.valor = this.valorServico;\n      this.atend.prontuario = this.prontuario;\n      this.atend.atendimento = this.finan.descricao;\n      this.atend.valor = this.valorServico;\n      this.service.salvarFinanceiro(this.finan).subscribe(response => {\n        this.sucessoAtend = true;\n        this.erroAtend = null;\n      }, errorResponse => {\n        this.sucessoAtend = false;\n        this.erroAtend = errorResponse.error.errors;\n      });\n      this.service.salvarAtendimento(this.atend).subscribe(response => {\n        this.sucessoAtend = true;\n        this.erroAtend = null;\n      }, errorResponse => {\n        this.erroAtend = errorResponse.error.errors;\n      });\n      setTimeout(() => window.location.reload(), 1000);\n    } else {\n      this.errors = [\"Deve salvar os dados do prontuário antes de enviar ao Financeiro\"];\n      this.erroAtend = [\"Deve salvar os dados do prontuário antes de enviar ao Financeiro\"];\n    }\n  }\n\n  onKeyUp(x) {\n    if (this.finan.valor) {\n      this.valorServico = this.finan.valor.toString();\n      this.valorServico = this.atend.valor.toString();\n    }\n\n    this.valorServico = this.valorServico + '';\n    this.valorServico = this.valorServico.replace(/\\D+/g, '');\n    this.valorServico = this.valorServico.replace(/([0-9]{2})$/g, \",$1\");\n\n    if (this.valorServico.length > 6) {\n      this.valorServico = this.valorServico.replace(/([0-9]{3}),([0-9]{2}$)/g, \".$1,$2\");\n    }\n\n    return this.valorServico;\n  }\n\n  dstFalse() {\n    this.prontuario.dst = false;\n  }\n\n  dstTrue() {\n    this.prontuario.dst = true;\n  }\n\n  cardiacoTrue() {\n    this.prontuario.cardiaco = true;\n  }\n\n  cardiacoFalse() {\n    this.prontuario.cardiaco = false;\n  }\n\n  epileticoTrue() {\n    this.prontuario.epiletico = true;\n  }\n\n  epileticoFalse() {\n    this.prontuario.epiletico = false;\n  }\n\n  gestanteTrue() {\n    this.prontuario.gestante = true;\n  }\n\n  gestanteFalse() {\n    this.prontuario.gestante = false;\n  }\n\n  diabeticoTrue() {\n    this.prontuario.diabetico = true;\n  }\n\n  diabeticoFalse() {\n    this.prontuario.diabetico = false;\n  }\n\n  hipertensoTrue() {\n    this.prontuario.hipertenso = true;\n  }\n\n  hipertensoFalse() {\n    this.prontuario.hipertenso = false;\n  }\n\n  salvarAnotacaoDente() {\n    this.prontuario.dentes[this.denteSelect] = this.anotacao;\n  }\n\n  preparaAnotacao(dente) {\n    this.denteSelect = dente.toString();\n  }\n\n  sort(key) {\n    this.key = key;\n    this.reverse = !this.reverse;\n  }\n\n  delecaoAtendimento(atend) {\n    this.service.delAtendimento(atend).subscribe(response => {\n      setTimeout(() => window.location.reload(), 1000);\n      this.erroAtendList = null;\n      this.sucessoAtendList = true;\n    }, errorResponse => {\n      this.sucessoAtend = null;\n      this.erroAtendList = errorResponse.error.errors;\n    });\n    this.finan.id = atend.id;\n    this.finan.descricao = atend.atendimento;\n    this.finan.valor = atend.valor;\n    this.service.delFinanceiro(this.finan).subscribe(response => {\n      setTimeout(() => window.location.reload(), 1000);\n      this.erroAtendList = null;\n      this.sucessoAtendList = true;\n    }, errorResponse => {\n      this.sucessoAtend = null;\n      this.erroAtendList = errorResponse.error.errors;\n    });\n  }\n\n};\nProntuarioFormComponent = __decorate([Component({\n  selector: 'app-prontuario-form',\n  templateUrl: './prontuario-form.component.html',\n  styleUrls: ['./prontuario-form.component.css']\n})], ProntuarioFormComponent);\nexport { ProntuarioFormComponent };","map":null,"metadata":{},"sourceType":"module"}